{% extends "enduser/base.html" %}
{% block title %}Profile{% endblock %}
{%load static %}
{% block content %}
<link rel="stylesheet" href="\static\css\user_profile.css">
<div class="profile-container">
    <form method="POST" enctype="multipart/form-data" class="mt-4" action="">
        {% csrf_token %}  
        <div class="image-card">
            <div class="text-center mb-4">
                <div class="position-relative d-inline-block mt-3" style="width: 125px; height: 125px; background-color: black; border-radius: 50%;">
                    <img id="profilePic" src="{% static user_detaits.profile_photo_url|default:'' %}" alt="Profile" class="rounded-circle w-100 h-100" style="object-fit: cover;">
                    <button type="button" class="btn btn-primary position-absolute top-50 start-50 translate-middle rounded-circle" onclick="selectImage()">+</button>
                    <input type="file" id="imageInput" name="profile_picture" accept="image/*" style="display: none;" onchange="setImage(event)">
                </div>
            </div>
        </div>   
            <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="firstName" class="form-label"><i class="bi bi-person"></i> First Name</label>
                        <input type="text" class="form-control" id="firstName" name="first_name" value="{{ user_details.first_name }}">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="lastName" class="form-label"><i class="bi bi-person"></i> Middle Name</label>
                        <input type="text" class="form-control" id="middleName" name="middle_name" value="{{ user_details.middle_name|default:'' }}">
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="lastName" class="form-label"><i class="bi bi-person"></i>Last Name</label>
                        <input type="text" class="form-control" id="lastName" name="last_name" value="{{ user_details.last_name }}">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="email" class="form-label"><i class="bi bi-envelope"></i> Email</label>
                        <input type="email" class="form-control" id="email" name="email" value="{{ user_details.email|default:'' }}">
                    </div>
                </div>
    
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="phone" class="form-label"><i class="bi bi-telephone-fill"></i> Phone</label>
                        <input type="text" class="form-control" id="phone" name="phone" value="{{ user_details.phone|default:'' }}">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="gender" class="form-label"><i class="bi bi-gender-ambiguous"></i> Gender</label>
                        <select class="form-select form-control" id="gender" name="gender">
                            <option value="Male" {% if user_details.gender == 1 %}selected{% endif %}>Male</option>
                            <option value="Female" {% if user_details.gender == 2 %}selected{% endif %}>Female</option>
                            <option value="Other" {% if user_details.gender == 3 %}selected{% endif %}>Other</option>
                        </select>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="dob" class="form-label">Date of Birth</label>
                        <input type="date" class="form-control" id="dob" name="dob" value="{{ user_details.dob|date:'Y-m-d'|default_if_none:'' }}">
                    </div>
                </div>
                <div class="d-flex justify-content-center gap-3">
                    <button type="submit" class="btn btn-primary w-25">Update</button>
                    <a href="javascript:history.back()" class="btn btn-danger w-25">Cancel</a>
                </div>          
            </form>
        </div>
    </div>
</form>
</div>
    <script>
        function selectImage() {
            document.getElementById("imageInput").click();
        }
        
        function setImage(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    document.getElementById("profilePic").src = e.target.result;
                    document.querySelector('.btn-primary').style.display = 'none';
                };
                reader.readAsDataURL(file);
            }
        }
    </script>    
{% endblock %}



